!function($){function initSelects(){$("select:not(.select2-hidden-accessible)").each(function(i,el){if(!$(el).closest(".entry.tpl").length){var options=$(this).data("select2-options");if(options){$.each(options,function(key,val){-1!==String(val).indexOf("function(")&&(eval("var fn = "+val),options[key]=fn)});var sortable=void 0!==options.sortable&&options.sortable,defaultOptions={containerCssClass:"crown-select2-selection",dropdownCssClass:"crown-select2-dropdown",templateResult:function(s){var e=s.text.match(/^\s+/);if(e){var t=e[0].length/3;return $('<span class="option-depth depth-'+t+'">'+s.text.trim()+"</span>")}return s.text},templateSelection:function(s){return s.text.trim()}},options=$.extend({},defaultOptions,options);if(options.containerCssClass!=defaultOptions.containerCssClass){for(var classes=options.containerCssClass.split(" "),classNames=[],i=0;i<classes.length;i++){var className=classes[i].trim();""!=className&&classNames.push(className)}-1===classNames.indexOf(defaultOptions.containerCssClass)&&classNames.push(defaultOptions.containerCssClass),options.containerCssClass=classNames.join(" ")}if(options.dropdownCssClass!=defaultOptions.dropdownCssClass){for(var classes=options.dropdownCssClass.split(" "),classNames=[],i=0;i<classes.length;i++){var className=classes[i].trim();""!=className&&classNames.push(className)}-1===classNames.indexOf(defaultOptions.dropdownCssClass)&&classNames.push(defaultOptions.dropdownCssClass),options.dropdownCssClass=classNames.join(" ")}sortable&&(delete options.sortable,options.templateSelection=function(s){var e=$("<span>"+s.text.trim()+"</span>");return e.addClass("label").data("option-value",s.element.value),e}),$(this).select2(options),sortable&&($(el).siblings(".select2-container").find("ul.select2-selection__rendered").sortable({items:"> li.select2-selection__choice",update:function(s,e){var t=$(s.target),n=t.closest(".select2-container").siblings("select.select2-hidden-accessible"),a=[];$("> li.select2-selection__choice",t).each(function(s,t){var e=$("option",n).filter(function(s,e){return $(e).val()==$("span.label",t).data("option-value")}).first();e.length&&a.push(e)});for(var l=a.length-1;0<=l;l--)n.prepend(a[l])}}),$(el).on("select2:select",function(s){var e=s.params.data.id,t=$(this).children("option[value="+e+"]");t.length&&(t.detach(),$("option:selected",this).length?$("option:selected",this).last().after(t):$(this).prepend(t)),$(this).trigger("change")}))}}})}$(document).ready(initSelects),$(document).on("repeaterEntryAdded",".entry",initSelects)}(jQuery);