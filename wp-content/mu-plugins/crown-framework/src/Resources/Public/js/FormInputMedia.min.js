!function(n){var t,a,i=new Array;function e(e){e.preventDefault(),a=!1,t=n(this).closest(".crown-media-input"),targetCrownMediaInputName=n("input[type=hidden]",t).attr("name"),t.parents(".ui-dialog").length&&(n(".ui-widget-overlay, .ui-dialog").hide(),a=!0),i[targetCrownMediaInputName]||(i[targetCrownMediaInputName]=wp.media.frames.crownMediaFrames[targetCrownMediaInputName]=wp.media({title:"Select File",button:{text:"Continue"},library:{type:t.data("media-mime-type")},multiple:!1}),i[targetCrownMediaInputName].on("select",function(e){i[targetCrownMediaInputName].state().get("selection").map(function(e){!function(e,t){e.addClass("has-media"),n("input[type=hidden]",e).val(t.id);var i=t.icon;{"image"==t.type&&(i=t.hasOwnProperty("sizes")?t.sizes.medium?t.sizes.medium.url:t.sizes.full.url:t.hasOwnProperty("url")?t.url:"")}n(".media-input-preview",e).html('<img src="'+i+'" />'),n("span.media-input-name",e).html(String(t.url.match(/\/[^\/]+$/)).substr(1)),a&&(n(".ui-widget-overlay, .ui-dialog").show(),n(".ui-dialog > .ui-dialog-content").dialog("option","position",{my:"center",at:"center",of:window}))}(t,e.toJSON())})})),i[targetCrownMediaInputName].open()}function o(e){e.preventDefault();var t=n(this).closest(".crown-media-input");t.removeClass("has-media"),n("input[type=hidden]",t).val(""),n("span.media-input-preview, span.media-input-name",t).html(""),a&&n(".ui-dialog > .ui-dialog-content").dialog("option","position",{my:"center",at:"center",of:window})}n(document).ready(function(){n(document).on("click",".crown-media-input a.media-input-button",e),n(document).on("click",".crown-media-input a.media-input-remove",o),wp.media.frames.crownMediaFrames=new Array})}(jQuery);